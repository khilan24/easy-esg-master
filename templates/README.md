# 模板目录

将以下文件放入此目录：

- `ESG研报模板.docx` — Word 报告模板（必需）
- `ESG研报模板.pptx` — PPT 报告模板（必需，每次输出均包含 Word 与 PPT）

---

## PPT 模板占位符设置说明（便于程序正确填充、避免 PowerPoint 报错）

程序使用 **python-pptx** 在**段落级别**做文本替换，只认「整段文字里的 `{{占位符名}}`」。请按下面方式设置，以保证填充后文件合法、不触发「PowerPoint 发现内容有问题」的修复提示。

### 1. 占位符写法（与 Word 一致）

在文本框里输入**双花括号 + 占位符名 + 双花括号**，例如：

| 占位符 | 说明 |
|--------|------|
| `{{日期范围}}` | 报告日期范围 |
| `{{报告日期}}` | 报告日期（仅 PPT 有） |
| `{{热点聚焦}}` | 热点聚焦正文 |
| `{{环境章节标题}}` | 环境章节标题 |
| `{{环境新闻标题1}}` ~ `{{环境新闻标题8}}` | 环境新闻标题 |
| `{{环境新闻内容1}}` ~ `{{环境新闻内容8}}` | 环境新闻正文 |
| `{{社会章节标题}}` / `{{社会新闻标题n}}` / `{{社会新闻内容n}}` | 社会章节 |
| `{{治理章节标题}}` / `{{治理新闻标题n}}` / `{{治理新闻内容n}}` | 治理章节 |

### 2. 推荐做法（保留你在 PPT 里设置的格式）

- **一个占位符尽量在一个「 run 」内**：程序会按 **run** 替换（只改文字，不改字体、字号、颜色等）。若 `{{占位符名}}` 完整地在一个 run 里（即你一次性输入、未在中间切换格式），该 run 的格式会完整保留。
- **做法**：在文本框里直接输入 `{{热点聚焦}}`，不要在其中间改字体/加粗/颜色等，这样整段占位符属于同一 run，替换后会保留你设的格式。
- **不要拆分占位符**：不要写成 `{{热点` 和 `聚焦}}` 两段或两个 run，否则会走「整段替换」后备逻辑，该段格式可能被重置。
- **换行**：替换内容里的换行会按 PPT 规范插入软换行，多行内容会正确换行显示。

### 3. 程序如何替换（供排查用）

- 程序优先用 **python-pptx**：按「幻灯片 → 形状 → 段落」遍历，对每个段落的 `paragraph.text` 做字符串替换 `{{占位符名}}` → 报告内容，再写回 `paragraph.text`，最后保存。这样生成的 PPT 结构合法，一般不触发修复。
- 若未安装或无法使用 python-pptx，会回退到「解包 pptx → 改 XML → 再打包」的方式，可能因 XML 结构被改动而触发 PowerPoint 修复提示。

### 4. 若仍出现「PowerPoint 发现内容有问题」

- 确认本机已安装 `python-pptx`（`pip install python-pptx`），程序会优先走 python-pptx 路径。
- 检查模板中占位符是否**整段**、**连续**书写，无多余空格或拆行。
- 若必须用 XML 回退路径，请尽量保证模板里每个占位符在 PPT 中对应**单独一个文本框/段落**，便于程序只做整段替换、少动 XML 结构。
